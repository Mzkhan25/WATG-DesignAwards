/*! designawards 2017-05-24 */
!function(){"use strict";var modules=["ngRoute","ngFileUpload","angular.filter"];angular.module("watgDesignAwards",modules)}(),function(){"use strict";function addCategoryController($scope,$rootScope,$routeParams,$location,$filter,$timeout,$window,categoryService){function getAll(){$scope.busyGettingData=!0,categoryService.getAll().then(function(results){for(var i=0;i<results.length;i++)results[i].Image=$rootScope.arrayBufferToBase64(results[i].Image);$scope.records=results,$scope.busyGettingData=!1})}$scope.uploadPic=function(file){$scope.categoryImage&&$scope.categoryName&&categoryService.save(file,$scope.categoryName)},$rootScope.categoryUploaded=function(){getAll()},$scope.modalClicked=function(shortCurrencyName,imageBlob){$scope.shortCurrencyName=shortCurrencyName,$scope.imageBlob=imageBlob},$scope.delete=function(id){categoryService.delete(id).then(function(result){getAll()})},$rootScope.validate(),getAll()}angular.module("watgDesignAwards").controller("addCategoryController",["$scope","$rootScope","$routeParams","$location","$filter","$timeout","$window","categoryService",addCategoryController])}(),function(){"use strict";function addProjectController($scope,$rootScope,$routeParams,$location,$filter,$timeout,$window,categoryService,projectService){function getAllCategories(){$scope.busyGettingData=!0,categoryService.getAll().then(function(results){$scope.categories=results;for(var i=0;i<results.length;i++)$scope.categoryList.push(angular.copy(results[i].CategoryName));$scope.busyGettingData=!1})}$scope.busyGettingData=!0,$scope.categories=[],$scope.categoryList=[],$rootScope.projectUploaded=function(){getAllCategories()},$scope.uploadPic=function(){projectService.save($scope.Project,$scope.DisplayImage,$scope.Pdf)},$rootScope.validate(),getAllCategories()}angular.module("watgDesignAwards").controller("addProjectController",["$scope","$rootScope","$routeParams","$location","$filter","$timeout","$window","categoryService","projectService",addProjectController])}(),function(){"use strict";function addUserController($scope,$rootScope,$routeParams,$location,$filter,$timeout,$window,userService){$scope.roles=[{Id:0,Name:"Admin"},{Id:1,Name:"User"}],$scope.saveUser=function(){userService.save($scope.User).then(function(result){alert(result)})},$rootScope.validate()}angular.module("watgDesignAwards").controller("addUserController",["$scope","$rootScope","$routeParams","$location","$filter","$timeout","$window","userService",addUserController])}(),function(){"use strict";function categoryController($scope,$rootScope,$routeParams,$location,$filter,$timeout,$window,categoryService){function getAll(){$scope.busyGettingData=!0,categoryService.getAll().then(function(results){for(var i=0;i<results.length;i++)results[i].Image=$rootScope.arrayBufferToBase64(results[i].Image);$scope.records=results,$rootScope.categories=results,$scope.busyGettingData=!1})}$scope.categoryList=[],$scope.busyGettingData=!0,$rootScope.arrayBufferToBase64=function(buffer){for(var binary="",bytes=new Uint8Array(buffer),len=bytes.byteLength,i=0;i<len;i++)binary+=String.fromCharCode(bytes[i]);return window.btoa(binary)},$scope.loadProjects=function(id){$location.path("/projects/"+id)},$rootScope.validate(),getAll()}angular.module("watgDesignAwards").controller("categoryController",["$scope","$rootScope","$routeParams","$location","$filter","$timeout","$window","categoryService",categoryController])}(),function(){"use strict";function loginController($scope,$rootScope,$routeParams,$location,$filter,$timeout,$window,userService){$scope.userPin="",$scope.invalidUserMsg="Please email helpdesk@watg.com in case you are unable to login to the design awards",$scope.invalidPINFlag=!1,$scope.busyGettingData=!1,$scope.login=function(){$scope.busyGettingData=!0,userService.login($scope.userPin).then(function(result){$rootScope.user=result,console.log($rootScope.user),1===result.Role?($scope.busyGettingData=!1,$location.path("/category")):0===result.Role?($scope.busyGettingData=!1,$location.path("/results")):($scope.invalidPINFlag=!0,$scope.busyGettingData=!1)})}}angular.module("watgDesignAwards").controller("loginController",["$scope","$rootScope","$routeParams","$location","$filter","$timeout","$window","userService",loginController])}(),function(){"use strict";function projectDetailController($scope,$rootScope,$routeParams,$location,$filter,$timeout,$window,projectService){$scope.busyGettingData=!0,$scope.projectId=$routeParams.projectId;var getProjectById=function(){projectService.getById($scope.projectId).then(function(result){result[0].DisplayImage=$rootScope.arrayBufferToBase64(result[0].DisplayImage),$scope.project=result[0],$scope.busyGettingData=!1})};$scope.getProject=function(){$window.open($scope.project.PdfPath)},$rootScope.validate(),getProjectById()}angular.module("watgDesignAwards").controller("projectDetailController",["$scope","$rootScope","$routeParams","$location","$filter","$timeout","$window","projectService",projectDetailController])}(),function(){"use strict";function projectsController($scope,$rootScope,$routeParams,$location,$filter,$timeout,$window,projectService,resultService){$scope.categoryId=$routeParams.categoryId,$scope.projectList=[],$scope.voted="",$scope.voteStatus="",$scope.voteResponse=!1,$scope.disbleVotBtn=!1,$scope.busyGettingData=!0;var getProjectByCategory=function(){projectService.getByCategory($scope.categoryId).then(function(results){for(var i=0;i<results.length;i++)results[i].DisplayImage=$rootScope.arrayBufferToBase64(results[i].DisplayImage);$scope.projectList=results,$scope.busyGettingData=!1})},voteAlreadyCasted=function(){resultService.checkUserVote($scope.categoryId,$rootScope.user.Id).then(function(result){$scope.hasAlreadyVoted=result,getProjectByCategory()})};$scope.loadProjects=function(categoryId){$location.path("/projects/"+categoryId)},$scope.saveVote=function(projectId,categoryId){var voteRequest={UserId:$rootScope.user.Id,ProjectId:projectId,CategoryId:categoryId};$scope.disbleVotBtn=!0,resultService.save(voteRequest).then(function(response){$scope.voteResponse=!0})},$scope.selectedProject=function(id){$location.path("/projectDetail/"+id)},$rootScope.validate(),voteAlreadyCasted()}angular.module("watgDesignAwards").controller("projectsController",["$scope","$rootScope","$routeParams","$location","$filter","$timeout","$window","projectService","resultService",projectsController])}(),function(){"use strict";function resultController($scope,$rootScope,$routeParams,$location,$filter,$timeout,$window,resultService){var getResults=function(){resultService.getAll().then(function(result){$scope.resultList=result,$scope.busyGettingData=!1})};$scope.busyGettingData=!0,$rootScope.validate(),getResults()}angular.module("watgDesignAwards").controller("resultController",["$scope","$rootScope","$routeParams","$location","$filter","$timeout","$window","resultService",resultController])}(),function(){function appConfig($httpProvider,$routeProvider,$locationProvider){$httpProvider.defaults.useXDomain=!0,$locationProvider.hashPrefix(""),delete $httpProvider.defaults.headers.common["X-Requested-With"],$routeProvider.when("/category",{templateUrl:"app/views/category.html",controller:"categoryController"}).when("/login",{templateUrl:"app/views/login.html",controller:"loginController"}).when("/projects/:categoryId?",{templateUrl:"app/views/projects.html",controller:"projectsController"}).when("/addCategory",{templateUrl:"app/views/addCategory.html",controller:"addCategoryController"}).when("/addUser",{templateUrl:"app/views/addUser.html",controller:"addUserController"}).when("/addProject",{templateUrl:"app/views/addProject.html",controller:"addProjectController"}).when("/projectDetail/:projectId?",{templateUrl:"app/views/projectDetail.html",controller:"projectDetailController"}).when("/results",{templateUrl:"app/Views/results.html",controller:"resultController"}).otherwise({redirectTo:"/login"})}function appRun($rootScope,$location,$interval,$filter,appService){$rootScope.pageTitle="WATG| Design Awards",$rootScope.form={},$rootScope.user={},$rootScope.userApplicationRoles=[],$rootScope.currentRoute="/Login",$rootScope.user="unauthorized",$rootScope.arrayBufferToBase64=function(buffer){for(var binary="",bytes=new Uint8Array(buffer),len=bytes.byteLength,i=0;i<len;i++)binary+=String.fromCharCode(bytes[i]);return window.btoa(binary)},$rootScope.validate=function(){"unauthorized"===$rootScope.user&&$location.path("/login")},$rootScope.logOut=function(){$rootScope.user="unauthorized",$location.path("/login")},$rootScope.makeFolders=function(){appService.makeNecessarryFolders().then(function(response){console.log(response+"Folder make result")})},$rootScope.makeFolders()}var app=angular.module("watgDesignAwards");app.config(["$httpProvider","$routeProvider","$locationProvider",appConfig]),app.run(["$rootScope","$location","$interval","$filter","appService",appRun])}(),angular.module("watgDesignAwardsConst",[]).constant("CONST_WATGXRESTAPIURL","http://localhost:8080/api").constant("CONST_RESOURCEURL","http://localhost:8081").constant("CONST_LOGSENABLED",!0).constant("CONST_W1_STAFF_PROFILE_URL","http://itstage.watg.com/watg1/#teamMemberDetails/"),function(){"use strict";function appService($http,$rootScope){return{makeNecessarryFolders:function(){return $http({method:"GET",url:"Util/MakeNecessarryFolders"}).then(function(response){return response.data})}}}angular.module("watgDesignAwards").factory("appService",["$http","$rootScope",appService])}(),function(){"use strict";function categoryService($http,Upload,$rootScope){return{getAll:function(){return $http({method:"GET",url:"Category/GetAll"}).then(function(response){return response.data})},getOne:function(id){return $http({method:"GET",url:"Category/GetOne?id="+id}).then(function(response){return response.data})},save:function(file,name){Upload.upload({url:"Category/Save",data:{name:name,file:file}}).then(function(resp){$rootScope.categoryUploaded()})},delete:function(id){return $http({method:"POST",data:{id:id},url:"Category/Delete?id="+id}).then(function(response){return response.data})}}}angular.module("watgDesignAwards").factory("categoryService",["$http","Upload","$rootScope",categoryService])}(),function(){"use strict";function projectService($http,Upload,$rootScope){return{getAll:function(){return $http({method:"GET",url:"Project/GetAll"}).then(function(response){return response.data})},getByCategory:function(id){return $http({method:"GET",url:"Project/GetByCategory?id="+id}).then(function(response){return response.data})},getById:function(id){return $http({method:"GET",url:"Project/GetById?id="+id}).then(function(response){return response.data})},save:function(project,image,document){Upload.upload({url:"Project/Save",data:{project:project,image:image,document:document}}).then(function(resp){$rootScope.projectUploaded()})}}}angular.module("watgDesignAwards").factory("projectService",["$http","Upload","$rootScope",projectService])}(),function(){"use strict";function resultService($http,$rootScope){return{getAll:function(){return $http({method:"GET",url:"Result/GetAll"}).then(function(response){return response.data})},getOne:function(id){return $http({method:"GET",url:"Result/GetOne?id="+id}).then(function(response){return response.data})},checkUserVote:function(categoryId,userId){return $http({method:"GET",url:"Result/CheckUserVote?categoryId="+categoryId+"&userId="+userId}).then(function(response){return response.data})},save:function(result){return $http({method:"POST",data:{result:result},url:"Result/Save/"}).then(function(response){return response.data})}}}angular.module("watgDesignAwards").factory("resultService",["$http","$rootScope",resultService])}(),function(){"use strict";function userService($http,$rootScope){return{getAll:function(){return $http({method:"GET",url:"User/GetAll"}).then(function(response){return response.data})},login:function(password){return $http({method:"GET",url:"User/Login?password="+password}).then(function(response){return response.data})},save:function(user){return $http({method:"POST",data:{user:user},url:"User/Save/"}).then(function(response){return response.data})},delete:function(id){return $http({method:"POST",data:{id:id},url:"User/Delete?id="+id}).then(function(response){return response.data})}}}angular.module("watgDesignAwards").factory("userService",["$http","$rootScope",userService])}();